{"ast":null,"code":"import _objectWithoutProperties from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\BoiPoka\\\\front-end\\\\src\\\\components\\\\Messages\\\\Messages.js\";\nimport React, { Component } from 'react';\nimport { AuthUserContext } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport MessageList from './MessageList';\n\nvar Messages = /*#__PURE__*/function (_Component) {\n  _inherits(Messages, _Component);\n\n  function Messages(props) {\n    var _this;\n\n    _classCallCheck(this, Messages);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Messages).call(this, props));\n\n    _this.onListenForMessages = function () {\n      _this.setState({\n        loading: true\n      });\n\n      _this.props.firebase.messages().orderByChild('createdAt').limitToLast(_this.state.limit).on('value', function (snapshot) {\n        var messageObject = snapshot.val();\n\n        if (messageObject) {\n          var messageList = Object.keys(messageObject).map(function (key) {\n            return _objectSpread({}, messageObject[key], {\n              uid: key\n            });\n          });\n\n          _this.setState({\n            messages: messageList,\n            loading: false\n          });\n        } else {\n          _this.setState({\n            messages: null,\n            loading: false\n          });\n        }\n      });\n    };\n\n    _this.onChangeText = function (event) {\n      _this.setState({\n        text: event.target.value\n      });\n    };\n\n    _this.onCreateMessage = function (event, authUser) {\n      _this.props.firebase.messages().push({\n        text: _this.state.text,\n        userId: authUser.uid,\n        createdAt: _this.props.firebase.serverValue.TIMESTAMP\n      });\n\n      _this.setState({\n        text: ''\n      });\n\n      event.preventDefault();\n    };\n\n    _this.onEditMessage = function (message, text) {\n      var uid = message.uid,\n          messageSnapshot = _objectWithoutProperties(message, [\"uid\"]);\n\n      _this.props.firebase.message(message.uid).set(_objectSpread({}, messageSnapshot, {\n        text: text,\n        editedAt: _this.props.firebase.serverValue.TIMESTAMP\n      }));\n    };\n\n    _this.onRemoveMessage = function (uid) {\n      _this.props.firebase.message(uid).remove();\n    };\n\n    _this.onNextPage = function () {\n      _this.setState(function (state) {\n        return {\n          limit: state.limit + 5\n        };\n      }, _this.onListenForMessages);\n    };\n\n    _this.state = {\n      text: '',\n      loading: false,\n      messages: [],\n      limit: 5\n    };\n    return _this;\n  }\n\n  _createClass(Messages, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.onListenForMessages();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.firebase.messages().off();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          text = _this$state.text,\n          messages = _this$state.messages,\n          loading = _this$state.loading;\n      return /*#__PURE__*/React.createElement(AuthUserContext.Consumer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 7\n        }\n      }, function (authUser) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 11\n          }\n        }, !loading && messages && /*#__PURE__*/React.createElement(\"button\", {\n          type: \"button\",\n          onClick: _this2.onNextPage,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }\n        }, \"More\"), loading && /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 25\n          }\n        }, \"Loading ...\"), messages && /*#__PURE__*/React.createElement(MessageList, {\n          authUser: authUser,\n          messages: messages,\n          onEditMessage: _this2.onEditMessage,\n          onRemoveMessage: _this2.onRemoveMessage,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 15\n          }\n        }), !messages && /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 27\n          }\n        }, \"There are no messages ...\"), /*#__PURE__*/React.createElement(\"form\", {\n          onSubmit: function onSubmit(event) {\n            return _this2.onCreateMessage(event, authUser);\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"text\",\n          value: text,\n          onChange: _this2.onChangeText,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 15\n          }\n        }), /*#__PURE__*/React.createElement(\"button\", {\n          type: \"submit\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 15\n          }\n        }, \"Send\")));\n      });\n    }\n  }]);\n\n  return Messages;\n}(Component);\n\nexport default withFirebase(Messages);","map":{"version":3,"sources":["C:/Users/User/Desktop/BoiPoka/front-end/src/components/Messages/Messages.js"],"names":["React","Component","AuthUserContext","withFirebase","MessageList","Messages","props","onListenForMessages","setState","loading","firebase","messages","orderByChild","limitToLast","state","limit","on","snapshot","messageObject","val","messageList","Object","keys","map","key","uid","onChangeText","event","text","target","value","onCreateMessage","authUser","push","userId","createdAt","serverValue","TIMESTAMP","preventDefault","onEditMessage","message","messageSnapshot","set","editedAt","onRemoveMessage","remove","onNextPage","off"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n\r\nimport { AuthUserContext } from '../Session';\r\nimport { withFirebase } from '../Firebase';\r\nimport MessageList from './MessageList';\r\n\r\nclass Messages extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      text: '',\r\n      loading: false,\r\n      messages: [],\r\n      limit: 5,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.onListenForMessages();\r\n  }\r\n\r\n  onListenForMessages = () => {\r\n    this.setState({ loading: true });\r\n\r\n    this.props.firebase\r\n      .messages()\r\n      .orderByChild('createdAt')\r\n      .limitToLast(this.state.limit)\r\n      .on('value', snapshot => {\r\n        const messageObject = snapshot.val();\r\n\r\n        if (messageObject) {\r\n          const messageList = Object.keys(messageObject).map(key => ({\r\n            ...messageObject[key],\r\n            uid: key,\r\n          }));\r\n\r\n          this.setState({\r\n            messages: messageList,\r\n            loading: false,\r\n          });\r\n        } else {\r\n          this.setState({ messages: null, loading: false });\r\n        }\r\n      });\r\n  };\r\n\r\n  componentWillUnmount() {\r\n    this.props.firebase.messages().off();\r\n  }\r\n\r\n  onChangeText = event => {\r\n    this.setState({ text: event.target.value });\r\n  };\r\n\r\n  onCreateMessage = (event, authUser) => {\r\n    this.props.firebase.messages().push({\r\n      text: this.state.text,\r\n      userId: authUser.uid,\r\n      createdAt: this.props.firebase.serverValue.TIMESTAMP,\r\n    });\r\n\r\n    this.setState({ text: '' });\r\n\r\n    event.preventDefault();\r\n  };\r\n\r\n  onEditMessage = (message, text) => {\r\n    const { uid, ...messageSnapshot } = message;\r\n\r\n    this.props.firebase.message(message.uid).set({\r\n      ...messageSnapshot,\r\n      text,\r\n      editedAt: this.props.firebase.serverValue.TIMESTAMP,\r\n    });\r\n  };\r\n\r\n  onRemoveMessage = uid => {\r\n    this.props.firebase.message(uid).remove();\r\n  };\r\n\r\n  onNextPage = () => {\r\n    this.setState(\r\n      state => ({ limit: state.limit + 5 }),\r\n      this.onListenForMessages,\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { text, messages, loading } = this.state;\r\n\r\n    return (\r\n      <AuthUserContext.Consumer>\r\n        {authUser => (\r\n          <div>\r\n            {!loading && messages && (\r\n              <button type=\"button\" onClick={this.onNextPage}>\r\n                More\r\n              </button>\r\n            )}\r\n\r\n            {loading && <div>Loading ...</div>}\r\n\r\n            {messages && (\r\n              <MessageList\r\n                authUser={authUser}\r\n                messages={messages}\r\n                onEditMessage={this.onEditMessage}\r\n                onRemoveMessage={this.onRemoveMessage}\r\n              />\r\n            )}\r\n\r\n            {!messages && <div>There are no messages ...</div>}\r\n\r\n            <form\r\n              onSubmit={event =>\r\n                this.onCreateMessage(event, authUser)\r\n              }\r\n            >\r\n              <input\r\n                type=\"text\"\r\n                value={text}\r\n                onChange={this.onChangeText}\r\n              />\r\n              <button type=\"submit\">Send</button>\r\n            </form>\r\n          </div>\r\n        )}\r\n      </AuthUserContext.Consumer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withFirebase(Messages);\r\n"]},"metadata":{},"sourceType":"module"}